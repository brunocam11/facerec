{
  "family": "facerec-worker-task-staging",
  "requiresCompatibilities": ["EC2"],
  "networkMode": "bridge",
  "cpu": 8192,
  "memory": 14336,
  "executionRoleArn": "arn:aws:iam::431835747280:role/facerec-ecs-task-execution-role-staging",
  "taskRoleArn": "arn:aws:iam::431835747280:role/facerec-ecs-task-role-staging",
  "containerDefinitions": [
    {
      "name": "facerec-worker",
      "image": "${ECR_REPOSITORY_URI}:latest",
      "cpu": 8192,
      "memory": 14336,
      "essential": true,
      "linuxParameters": {
        "sharedMemorySize": 4300
      },
      "environment": [
        {
          "name": "RAY_MEMORY_PER_PROCESS",
          "value": "0.5"
        },
        {
          "name": "AWS_REGION",
          "value": "${AWS_REGION}"
        },
        {
          "name": "PINECONE_INDEX_NAME",
          "value": "lumepic-faces-staging"
        },
        {
          "name": "MIN_FACE_CONFIDENCE",
          "value": "0.65"
        },
        {
          "name": "PINECONE_API_KEY",
          "value": "pcsk_2jWTfZ_HCQTyqAYFMR4dyUSVzrixwKn7H2fh5vJfEiZ2Q9gVYhBbbqXQaQZ87J21PHmtna"
        },
        {
          "name": "SQS_BATCH_SIZE",
          "value": "10"
        },
        {
          "name": "S3_BUCKET_REGION",
          "value": "${AWS_REGION}"
        },
        {
          "name": "AWS_S3_BUCKET",
          "value": "spotted-staging-images-protected"
        },
        {
          "name": "MAX_FACES_PER_IMAGE",
          "value": "10"
        },
        {
          "name": "SIMILARITY_THRESHOLD",
          "value": "0.8"
        },
        {
          "name": "CONTAINER_MEMORY_THRESHOLD",
          "value": "0.85"
        },
        {
          "name": "SQS_QUEUE_NAME",
          "value": "facerec-indexing-staging-queue"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/facerec-facerec-worker-staging",
          "awslogs-region": "${AWS_REGION}",
          "awslogs-stream-prefix": "ecs"
        }
      }
    }
  ],
  "tags": [
    {
      "key": "Name",
      "value": "facerec-worker-task-staging"
    },
    {
      "key": "Environment",
      "value": "staging"
    },
    {
      "key": "Project",
      "value": "facerec"
    }
  ]
} 